{"primaryContentSections":[{"kind":"content","content":[{"anchor":"overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To understand smoothly about Verge, we need to figure the following domains out."}]},{"anchor":"Domains","level":2,"type":"heading","text":"Domains"},{"anchor":"Store","level":3,"type":"heading","text":"Store"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A storage object to manage a state and emit activities by the action."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Store can dispatch actions to itself."}]}]}]},{"anchor":"State","level":3,"type":"heading","text":"State"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A type of state-tree that describes the data our feature needs."}]}]}]},{"anchor":"Activity-Optional","level":3,"type":"heading","text":"Activity (Optional)"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A type that describes an activity that happens during performs the action."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This instance won’t be stored in anywhere. It would help us to perform something by event-driven."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Consider to use this depends on that if can be represented as a state."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"For example, to present alert or notifcitaions by the action."}]}]}]},{"anchor":"Action","level":3,"type":"heading","text":"Action"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Action runs any operations (sync \/ async) and commits any mutations to the state of the store."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Action is described by Swift’s method in Store or Dispatcher."}]}]}]},{"anchor":"Dispatcher-Optional","level":3,"type":"heading","text":"Dispatcher (Optional)"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"A type to dispatch an action to specific store."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"For a large application, to separate the logics each domain."}]}]}]},{"anchor":"Setup-a-Store","level":2,"type":"heading","text":"Setup a Store"},{"anchor":"Define-a-state","level":3,"type":"heading","text":"Define a state"},{"type":"codeListing","syntax":"swift","code":["struct MyState {","  var count = 0","}"]},{"anchor":"Define-an-activity","level":3,"type":"heading","text":"Define an activity"},{"type":"codeListing","syntax":"swift","code":["enum MyActivity {","  case countWasIncremented","}"]},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"Activity"},{"type":"text","text":" is not required type."},{"type":"text","text":" "},{"type":"text","text":"If you don’t need to use "},{"type":"codeVoice","code":"Activity"},{"type":"text","text":", you can set"},{"type":"codeVoice","code":"Never"},{"type":"text","text":" in Store’s type parameter."}]},{"anchor":"Define-a-store","level":3,"type":"heading","text":"Define a store"},{"type":"codeListing","syntax":"swift","code":["class MyStore: Store<MyState, MyActivity> {","","  init(dependency: Dependency) {","    super.init(initialState: .init(), logger: nil)","  }","","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In example, it created a subclass of "},{"type":"codeVoice","code":"Store"},{"type":"text","text":". Of course, we can also create an instance from "},{"type":"codeVoice","code":"Store"},{"type":"text","text":" without subclassing."},{"type":"text","text":" "},{"type":"text","text":"But we can put some dependencies (e.g. API client) with creating a sub-class of "},{"type":"codeVoice","code":"Store"},{"type":"text","text":"."}]},{"anchor":"Add-an-action","level":2,"type":"heading","text":"Add an action"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Next, add an action to mutate the state. Essentially, Verge uses Swift’s method to describe an action against enum or struct based action descriptor other Flux library has. This approach has advantages that adding an action faster and call it naturally and dispatches with a faster way by Swift’s native method dispatching system."}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Better Performance"}]}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Swift can perform this action with Swift’s method dispatching instead switch-case computing."}]}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Returns anything we need"}]}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"the action can return anything from that action (e.g. state or result)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If that action dispatch async operation, it can return "},{"type":"codeVoice","code":"Future"},{"type":"text","text":" object. (such as Vuex action)"}]}]}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"As a future direction, Verge might get a dispatching action system with describing with enum or struct based to run action."},{"type":"text","text":" "},{"type":"text","text":"However, the current approach would be the base system for it."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"We’re currently researching that needs."}]},{"type":"codeListing","syntax":"swift","code":["class MyStore: Store<MyState, MyActivity> {","\tfunc incrementCount() { ","    commit { ","      $0.count += 1 ","    } ","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Yes, this point is most different with Redux. we could say it close to Vuex. Store knows what the application’s needs."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"To mutate the state, we use "},{"type":"codeVoice","code":"commit"},{"type":"text","text":" method."},{"type":"text","text":" "},{"type":"text","text":"the argument inside commit’s closure is "},{"type":"codeVoice","code":"inout State"},{"type":"text","text":", you can modify it anything but you can’t put the asynchronous operations."},{"type":"text","text":" "},{"type":"text","text":"If you need to do this, call "},{"type":"codeVoice","code":"commit"},{"type":"text","text":" from the asynchronous operation. like this:"}]},{"type":"codeListing","syntax":"swift","code":["func incrementCount() {","  DispatchQueue.main.async {","    commit {","      $0.count += 1","    }","  }","}"]},{"anchor":"Run-the-action","level":3,"type":"heading","text":"Run the action"},{"type":"paragraph","inlineContent":[{"type":"text","text":"For example, call that action."}]},{"type":"codeListing","syntax":"swift","code":["let store = MyStore(...)","store.incrementCount()"]},{"anchor":"Send-an-activity-from-the-action","level":2,"type":"heading","text":"Send an activity from the action"},{"type":"codeListing","syntax":"swift","code":["func incrementCount() {","  ...","  send(.countWasIncremented)","}"]},{"anchor":"Binding-the-state-with-UI","level":2,"type":"heading","text":"Binding the state with UI"},{"anchor":"Use-the-store-in-SwiftUI","level":3,"type":"heading","text":"Use the store in SwiftUI"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To bind the state with "},{"type":"codeVoice","code":"View"},{"type":"text","text":", it uses "},{"type":"codeVoice","code":"StateReader"},{"type":"text","text":"."},{"type":"text","text":" "},{"type":"text","text":"Since "},{"type":"codeVoice","code":"Store"},{"type":"text","text":" is also compatible with "},{"type":"codeVoice","code":"ObservableObject"},{"type":"text","text":", we can declare "},{"type":"codeVoice","code":"@ObservedObject"},{"type":"text","text":" or "},{"type":"codeVoice","code":"@EnviromentObject"},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"StateReader"},{"type":"text","text":" provides several options to reduce no changes updates."},{"type":"text","text":" "},{"type":"text","text":"Please check it out from Xcode."}]},{"type":"codeListing","syntax":"swift","code":["struct MyView: View {","","  let store: MyStore","","  var body: some View {","    StateReader(store).content { state in","      Text(state.name)","    }","    .onReceive(session.store.activityPublisher) { (activity) in","      ...","    }","  }","}"]},{"anchor":"Use-the-store-in-UIKit","level":3,"type":"heading","text":"Use the store in UIKit"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In UIKit, UIKit doesn’t work with differentiating."},{"type":"text","text":" "},{"type":"text","text":"To keep better performance, we need to set a value if it’s changed."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Verge publishes an object that contains previous state and latest state, "},{"type":"codeVoice","code":"Changes"},{"type":"text","text":" object would be so helpful to check if a value changed."}]},{"type":"codeListing","syntax":"swift","code":["class ViewController: UIViewController {","","  let store: MyStore","","  var cancellable: VergeAnyCancellable?","","  init(store: MyStore) {","    ...","","    self.cancellable = store.sinkState { [weak self] state in","      self?.update(state: state)","    }","","  }","","  private func update(state: Changes<MyStore.State>) {","","    state.ifChanged(\\.name) { (name) in","      nameLabel.text = name","    }","","    state.ifChanged(\\.age) { (age) in","      ageLabel.text = age.description","    }","","  }","}"]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/verge\/basic-usage"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/Verge\/documentation\/Verge\/Basic-Usage","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"This section shows you how we start to use Verge."},{"type":"text","text":" "},{"type":"text","text":"It’s very basic usage. You need to read Advanced Usage section if you’re considering to use in production."}],"kind":"article","metadata":{"roleHeading":"Article","title":"Basic Usage","role":"article","modules":[{"name":"Verge"}]},"hierarchy":{"paths":[["doc:\/\/Verge\/documentation\/Verge"]]},"seeAlsoSections":[{"title":"Guides","identifiers":["doc:\/\/Verge\/documentation\/Verge\/Motivation","doc:\/\/Verge\/documentation\/Verge\/Advanced-Usage"],"generated":true}],"references":{"doc://Verge/documentation/Verge/Motivation":{"role":"article","title":"Motivation","abstract":[],"identifier":"doc:\/\/Verge\/documentation\/Verge\/Motivation","kind":"article","type":"topic","url":"\/documentation\/verge\/motivation"},"doc://Verge/documentation/Verge":{"role":"collection","title":"Verge","abstract":[],"identifier":"doc:\/\/Verge\/documentation\/Verge","kind":"symbol","type":"topic","url":"\/documentation\/verge"},"doc://Verge/documentation/Verge/Advanced-Usage":{"role":"article","title":"Advanced Usage","abstract":[],"identifier":"doc:\/\/Verge\/documentation\/Verge\/Advanced-Usage","kind":"article","type":"topic","url":"\/documentation\/verge\/advanced-usage"}}}